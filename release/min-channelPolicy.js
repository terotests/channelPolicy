(function(){var t={},n=function(){var n=function(){!function(t){t.guid=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},t.isArray=function(t){return t instanceof Array},t.isFunction=function(t){return"[object Function]"==Object.prototype.toString.call(t)},t.isObject=function(t){return t===Object(t)}}(this),function(t){t.constructClientToServer=function(t){var n=t.data;t.last_sent||(t.last_sent=[]);var e=t.last_sent[1]||0,r=n._journal.length;return e==r?null:(t.last_sent[0]=e,t.last_sent[1]=r,{id:this.guid(),c:n._journal.slice(e,r),start:e,end:r,version:t.version})},t.constructServerToClient=function(t){var n=t.data;t.last_update||(t.last_update=[]);var e=t.last_update[1]||0,r=n._journal.length;return e==r?null:(t.last_update[0]=e,t.last_update[1]=r,{c:n._journal.slice(e,r),start:e,end:r,version:t.version})},t.deltaClientToServer=function(t,n){n._done||(n._done={});try{if(!t.id)return;if(n._done[t.id])return res;n._done[t.id]=!0;for(var e=n.data,r=[],i=0;i<t.c.length;i++){var a=t.c[i],o=e.execCmd(a);o!==!0&&r.push(o)}return{errors:r}}catch(s){return s.message}},t.deltaServerToClient=function(t,n){var e=n.data;n.last_update||(n.last_update=[]);var r={goodCnt:0,oldCnt:0,newCnt:0,reverseCnt:0},i=t.start-1;if(!n.needsRefresh){if(t.start>e._journal.length)return n.needsRefresh=!0,r.fail=!0,r;for(var a=t.start;a<t.end;a++){var o=e.getJournalCmd(a),s=t.c[a-t.start],l=!0;if(o){for(var u=0;4>=u;u++)o[u]!=s[u]&&(l=!1);if(!l){e.reverseToLine(i);for(var a=i+1;a<t.end;a++){var s=t.c[a-t.start],f=e.execCmd(s,!0);if(f!==!0)return n.needsRefresh=!0,r.fail=!0,r.reason=f,r;r.reverseCnt++}n.last_update[0]=t.start,n.last_update[1]=t.end;break}i=a,r.goodCnt++,r.oldCnt++}else{var f=e.execCmd(s,!0);if(f!==!0)return n.needsRefresh=!0,r.fail=!0,r.reason=f,r;i=a,r.goodCnt++,r.newCnt++}}return r}}}(this)},e=function(t,n,r,i,a,o,s,l){var u,f=this;if(!(f instanceof e))return new e(t,n,r,i,a,o,s,l);var c=[t,n,r,i,a,o,s,l];if(f.__factoryClass)if(f.__factoryClass.forEach(function(t){u=t.apply(f,c)}),"function"==typeof u){if(u._classInfo.name!=e._classInfo.name)return new u(t,n,r,i,a,o,s,l)}else if(u)return u;f.__traitInit?f.__traitInit.forEach(function(t){t.apply(f,c)}):"function"==typeof f.init&&f.init.apply(f,c)};e._classInfo={name:"_chPolicy"},e.prototype=new n,function(){"undefined"!=typeof define&&null!==define&&null!=define.amd?(t._chPolicy=e,this._chPolicy=e):"undefined"!=typeof module&&null!==module&&null!=module.exports?module.exports._chPolicy=e:this._chPolicy=e}.call(new Function("return this")()),function(t){t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(){})}(this)},e=function(t,n,r,i,a,o,s,l){var u,f=this;if(!(f instanceof e))return new e(t,n,r,i,a,o,s,l);var c=[t,n,r,i,a,o,s,l];if(f.__factoryClass)if(f.__factoryClass.forEach(function(t){u=t.apply(f,c)}),"function"==typeof u){if(u._classInfo.name!=e._classInfo.name)return new u(t,n,r,i,a,o,s,l)}else if(u)return u;f.__traitInit?f.__traitInit.forEach(function(t){t.apply(f,c)}):"function"==typeof f.init&&f.init.apply(f,c)};e._classInfo={name:"channelPolicyModule"},e.prototype=new n,"undefined"!=typeof define&&null!==define&&null!=define.amd&&define(t)}).call(new Function("return this")());